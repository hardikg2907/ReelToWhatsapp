{"version":3,"file":"background.js","mappings":"mBAqDA,SAASA,EAAsBC,EAAmBC,GAChD,MAAMC,EAAaC,SAASC,cAAc,WAAWJ,OAErD,GAAIE,EAAY,CAEd,MAAMG,EAAiB,IAAIC,WAAW,YAAa,CACjDC,SAAS,EACTC,YAAY,EACZC,KAAMC,SAGRR,EAAWS,cAAcN,GAGzBO,YAAW,KACT,IAAIC,EAAUV,SAASW,iBAAiB,4BACxCD,EAAUA,EAAQA,EAAQE,OAAS,GAC/BF,IACFA,EAAQG,QACRb,SAASc,YAAY,cAAc,EAAOhB,GAE1CW,YAAW,KACT,MAAMM,EAAaf,SAASC,cAAc,0BACtCc,GACFA,EAAWC,OACb,GACC,KACL,GACC,IACL,MACEC,QAAQC,IAAI,yBAEhB,CAGA,SAASC,EAAarB,GACpB,MAAMY,EAAUV,SAASW,iBAAiB,4BAC1CD,EAAUA,EAAQA,EAAQE,OAAS,GAC/BF,IACFA,EAAQG,QACRb,SAASc,YAAY,cAAc,EAAOhB,GAE1CW,YAAW,KACT,MAAMM,EAAaf,SAASC,cAAc,0BACtCc,GACFA,EAAWC,OACb,GACC,KAEP,CAnGAI,OAAOC,QAAQC,UAAUC,aAAY,CAACC,EAASC,EAAQC,KACrD,GAAqB,eAAjBF,EAAQG,KAAuB,CACjC,MAAM7B,EAAW0B,EAAQI,QAAQ9B,SAGjCsB,OAAOS,QAAQC,MAAMC,IAAI,CAAC,aAAc,iBAAkBC,IACxD,MAAMjC,EAAaiC,EAAKjC,WAClBkC,EAAeD,EAAKC,aAqC1B,OAlCAb,OAAOc,KAAKC,MAAM,CAAEC,IAAK,+BAAiCF,IACxD,GAAIA,EAAKtB,OAAS,EAAG,CACnB,IAAIyB,EAAcH,EAAK,GAGvBd,OAAOkB,UACJC,cAAc,CACbC,OAAQ,CAAEC,MAAOJ,EAAYK,IAC7BC,KAAM/C,EACNgD,KAAM,CAAC7C,EAAYD,KAEpB+C,MAAK,KACJnB,EAAa,CAAEoB,OAAQ,yCAA0C,GAEvE,MACE1B,OAAOc,KAAKa,OACV,CAAEX,IAAK,uCAAuCH,MAC7Ce,IAEC5B,OAAOkB,UACJC,cAAc,CACbC,OAAQ,CAAEC,MAAOO,EAAON,IACxBC,KAAMxB,EACNyB,KAAM,CAAC9C,KAER+C,MAAK,KACJnB,EAAa,CAAEoB,OAAQ,+BAAgC,GACvD,GAIV,KAGK,CAAI,GAEf,I","sources":["webpack://ReelToWhatsapp/./src/background.js"],"sourcesContent":["\"use strict\";\n\n// Listen for messages from the popup script\nchrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\n  if (message.type === \"SHARE_REEL\") {\n    const reelLink = message.payload.reelLink;\n\n    // Get saved targetChat and targetNumber from Chrome storage\n    chrome.storage.local.get([\"targetChat\", \"targetNumber\"], (data) => {\n      const targetChat = data.targetChat; // Phone number\n      const targetNumber = data.targetNumber; // Contact name\n\n      // Check if WhatsApp Web is already open\n      chrome.tabs.query({ url: \"https://web.whatsapp.com/*\" }, (tabs) => {\n        if (tabs.length > 0) {\n          let whatsappTab = tabs[0];\n\n          // Execute script to find and navigate to the chat\n          chrome.scripting\n            .executeScript({\n              target: { tabId: whatsappTab.id },\n              func: findAndNavigateToChat,\n              args: [targetChat, reelLink],\n            })\n            .then(() => {\n              sendResponse({ status: \"Navigated to chat and reel link sent!\" });\n            });\n        } else {\n          chrome.tabs.create(\n            { url: `https://web.whatsapp.com/send?phone=${targetNumber}` },\n            (newTab) => {\n              // setTimeout(() => {\n              chrome.scripting\n                .executeScript({\n                  target: { tabId: newTab.id },\n                  func: sendReelLink,\n                  args: [reelLink],\n                })\n                .then(() => {\n                  sendResponse({ status: \"Reel link sent to WhatsApp!\" });\n                });\n              // }, 15000); // Wait for WhatsApp Web to load\n            }\n          );\n        }\n      });\n\n      return true; // Indicate async response\n    });\n  }\n});\n\n// Function to search for and click on the chat\nfunction findAndNavigateToChat(targetNameOrPhone, reelLink) {\n  const targetChat = document.querySelector(`[title=\"${targetNameOrPhone}\"]`);\n\n  if (targetChat) {\n    // Simulate a click on the chat to navigate to it\n    const mouseDownEvent = new MouseEvent(\"mousedown\", {\n      bubbles: true,\n      cancelable: true,\n      view: window,\n    });\n\n    targetChat.dispatchEvent(mouseDownEvent);\n\n    // Once chat is opened, send the reel link\n    setTimeout(() => {\n      let chatBox = document.querySelectorAll(\"[contenteditable='true']\");\n      chatBox = chatBox[chatBox.length - 1];\n      if (chatBox) {\n        chatBox.focus();\n        document.execCommand(\"insertText\", false, reelLink);\n\n        setTimeout(() => {\n          const sendButton = document.querySelector(\"span[data-icon='send']\");\n          if (sendButton) {\n            sendButton.click(); // Simulate clicking the send button\n          }\n        }, 500);\n      }\n    }, 2000); // Wait for the chat to load\n  } else {\n    console.log(\"Target chat not found!\");\n  }\n}\n\n// Function to send the reel link in a new tab\nfunction sendReelLink(reelLink) {\n  const chatBox = document.querySelectorAll(\"[contenteditable='true']\");\n  chatBox = chatBox[chatBox.length - 1];\n  if (chatBox) {\n    chatBox.focus();\n    document.execCommand(\"insertText\", false, reelLink);\n\n    setTimeout(() => {\n      const sendButton = document.querySelector(\"span[data-icon='send']\");\n      if (sendButton) {\n        sendButton.click(); // Simulate clicking the send button\n      }\n    }, 500);\n  }\n}\n"],"names":["findAndNavigateToChat","targetNameOrPhone","reelLink","targetChat","document","querySelector","mouseDownEvent","MouseEvent","bubbles","cancelable","view","window","dispatchEvent","setTimeout","chatBox","querySelectorAll","length","focus","execCommand","sendButton","click","console","log","sendReelLink","chrome","runtime","onMessage","addListener","message","sender","sendResponse","type","payload","storage","local","get","data","targetNumber","tabs","query","url","whatsappTab","scripting","executeScript","target","tabId","id","func","args","then","status","create","newTab"],"sourceRoot":""}